[{"path":"https://r-computing-lab.github.io/ACEsimFit/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 SimFit authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/articles/ACEsimFit.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"ACEsimFit","text":"package designed 1) Simulating kin pairs data based assumption every trait affected genetic effects (), common environmental effects (C) unique environmental effects (E). 2) Using kin pairs data fit ACE model get model fit output. vignette, use height trait demonstrate people can simulate kin pairs height data use simulated data fit univariate ACE model. also discuss possible ways analyse model fitting results. 3) Calculate power heritability estimate given specific condition. (Note: ideas data vignette demonstration purpose can inaccurate terms true facts science.)","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/articles/ACEsimFit.html","id":"simulate-kin-pair-data","dir":"Articles","previous_headings":"","what":"Simulate kin pair data","title":"ACEsimFit","text":"Suppose situation like : wants investigate factors impact height adults non-European country. Researchers developed countries like US UK collected sea twin data explore question reached conclusion: 60% variance height comes genes, 20% variance comes family environment 20% comes personal environment error. wanted see conclusion holds true Asian country. One approach use public dataset height measure family structure records. However, dataset two problems: 1) 180 pairs twins 2) can distinguish MZ twins -sex DZ twins. Given problems dataset , useful priori power analysis check statistical power study. first need simulate data variance covariance structure data public dataset. can use kinsim_double function . ’s conditions want replicate: Sample sizes: 60 pairs opposite-sex DZ twins (genetic relatedness .5) 120 pairs -sex MZ DZ twins (genetic relatedness .75) relatedness .75 achieved combining MZ DZ twins instead simulating kin pairs relatedness .75 directly. ACE variance structure: = .6, C = .2, E = .2 Group mean 0, Z scores. Therefore, set parameters kinsim_double function like : Now can see data.frame 180 pairs simulated twins. also variance components information.","code":"kindata <- kinsim_double(   GroupNames = c(\"SStwins\", \"OStwins\"),   GroupSizes = c(120, 60),   GroupRel = c(.75, 0.5),   GroupR_c = c(1, 1),   mu = c(0, 0),   ace1 = c(.6, .2, .2),   ace2 = c(.6, .2, .2),   ifComb = TRUE ) head(kindata) #>    GroupName    R r_c id          A1          A2          C1          C2 #> 48   SStwins 0.75   1  1  0.02248168  0.02248168 -0.03448461 -0.03448461 #> 66   SStwins 0.75   1  2  0.87922301  0.73493224 -0.42473098 -0.42473098 #> 47   SStwins 0.75   1  3 -0.28043976 -0.28043976 -0.25064124 -0.25064124 #> 14   SStwins 0.75   1  4 -0.76368579 -0.76368579 -0.59577363 -0.59577363 #> 16   SStwins 0.75   1  5 -0.73345621 -0.73345621  0.18573124  0.18573124 #> 95   SStwins 0.75   1  6 -0.01048472 -0.06118696  0.19529037  0.19529037 #>             E1          E2          y1         y2 #> 48  0.09741996 -0.19555812  0.08541702 -0.2075610 #> 66 -0.49639316 -0.41603625 -0.04190114 -0.1058350 #> 47 -0.42105074 -0.03581002 -0.95213174 -0.5668910 #> 14 -0.33618089 -0.81363682 -1.69564031 -2.1730962 #> 16 -0.37056277  0.01884294 -0.91828774 -0.5288820 #> 95  0.39216748 -0.67556163  0.57697313 -0.5414582"},{"path":"https://r-computing-lab.github.io/ACEsimFit/articles/ACEsimFit.html","id":"calculate-the-power-of-the-heritability-estimate-given-the-variance-structure","dir":"Articles","previous_headings":"","what":"Calculate the power of the heritability estimate given the variance structure","title":"ACEsimFit","text":"Generally, calculating power estimate two approaches: likelihood theory least squares theory.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/articles/ACEsimFit.html","id":"calculate-power-based-on-likelihood-theory","dir":"Articles","previous_headings":"Calculate the power of the heritability estimate given the variance structure","what":"Calculate power based on likelihood theory","title":"ACEsimFit","text":"use likelihood theory, need simulate number datasets variance structure average suggested power set data. See detailed explanation link. need set model fitting results -2ll values ACE model CE model. Luckily, package function Sim_Fit simulate kin pairs data, fit automatically ACE model return model summary results. function fit ACE model help OpenMx package. , assigned parameters function. new parameters : want 50 simulated datasets power calculation can relatively accurate. set nIter = 50. Set iterations want get even accurate power. hope simulated results can replicated set SSeed = 62. Pick lucky number ! don’t want contrain estimation set lbound = FALSE. don’t need raw data since eat poor-RAM laptop. set saveRaw = FALSE. ’s one example nested comparison table results can calculated weighted ncp average difference log-likelihood ACE CE models.turn, calculated power given variance structure relatedness: can see power model insufficient confident estimate height heritability. :(","code":"time1 <- Sys.time() results_fit <- Sim_Fit(   GroupNames = c(\"SStwins\", \"OStwins\"),   GroupSizes = c(120, 60),   nIter = 50,   SSeed = 62,   GroupRel = c(.75, 0.5),   GroupR_c = c(1, 1),   mu = c(0, 0),   ace1 = c(.6, .2, .2),   ace2 = c(.6, .2, .2),   ifComb = TRUE,   lbound = FALSE,   saveRaw = FALSE ) time2 <- Sys.time() ## FYI, the time used for the results above is here. So design your simulation wisely!!! time2 - time1 #> Time difference of 42.67797 secs results_fit[[\"Iteration1\"]][[\"Results\"]][[\"nest\"]] #>            base comparison ep minus2LL  df      AIC     diffLL diffdf #> 1 oneACEvc_1cov       <NA>  4 896.1042 356 904.1042         NA     NA #> 2 oneACEvc_1cov    oneAEvc  3 897.0780 357 903.0780  0.9737667      1 #> 3 oneACEvc_1cov    oneCEvc  3 898.0232 357 904.0232  1.9190034      1 #> 4 oneACEvc_1cov     oneEvc  2 980.2935 358 984.2935 84.1892959      2 #>              p #> 1           NA #> 2 3.237426e-01 #> 3 1.659666e-01 #> 4 5.230301e-19 N <- 180 ## the total number of kin pairs you used in your previous simulation ## Calculate the average diffLL between ACE and CE model. DiffLL <- numeric() for (i in 1:50) {   DiffLL[i] <- results_fit[[1]][[\"Results\"]][[\"nest\"]]$diffLL[3] } meanDiffLL <- mean(DiffLL) ## Calculate the power based on an alpha level of .05 Power <- 1 - pchisq(qchisq(1 - .05, 1), 1, meanDiffLL) Power #> [1] 0.2831639"},{"path":"https://r-computing-lab.github.io/ACEsimFit/articles/ACEsimFit.html","id":"calculate-power-based-on-least-squares-theory","dir":"Articles","previous_headings":"Calculate the power of the heritability estimate given the variance structure","what":"Calculate power based on least squares theory","title":"ACEsimFit","text":"Unlike likelihood theory, don’t need run simulations calculate power can formula Xuanyu Mason’s paper (submitted; see link soon). function Power_LS designed power calculation based LS theory. typed parameters research question involved functions. can see power calculated LS theory different one likelihood theory. due 1) LS formula, ’t consider combination MZ DZ twins reach relatedness .75 2) different especially sample size small. case, 1800 pairs stead 180, power likelihood theory 0.9890003 power least squares theory 0.9960664. (Much similar time!)","code":"Power_LS(N1 = 120, N2 = 60, h2 = .6, c2 = .2, R1 = .75, R2 = 0.5, alpha = 0.05) #> [1] 0.3881047"},{"path":"https://r-computing-lab.github.io/ACEsimFit/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Xuanyu Lyu. Author, maintainer. S.Mason Garrison. Author.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lyu X, Garrison S (2025). ACEsimFit: ACE Kin Pair Data Simulations Model Fitting. R package version 0.0.1.0.","code":"@Manual{,   title = {ACEsimFit: ACE Kin Pair Data Simulations and Model Fitting},   author = {Xuanyu Lyu and S.Mason Garrison},   year = {2025},   note = {R package version 0.0.1.0}, }"},{"path":"https://r-computing-lab.github.io/ACEsimFit/index.html","id":"acesimfit","dir":"","previous_headings":"","what":"ACE Kin Pair Data Simulations and Model Fitting","title":"ACE Kin Pair Data Simulations and Model Fitting","text":"goal ACEsimFit 1) simulate kin pairs data based theory ACE models. 2) fit data ACE models","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"ACE Kin Pair Data Simulations and Model Fitting","text":"can install official version ACEsimFit like : can also install/update ACEsimFit development version ACEsimFit GitHub :","code":"install.packages(\"ACEsimFit\") # If devtools is not installed, uncomment the line below. # install.packages('ACEsimFit') devtools::install_github('R-Computing-Lab/ACEsimFit')"},{"path":"https://r-computing-lab.github.io/ACEsimFit/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"ACE Kin Pair Data Simulations and Model Fitting","text":"use ACEsimFit research wish refer , please cite following paper:","code":"citation(package = \"ACEsimFit\") Warning in citation(package = \"ACEsimFit\"): could not determine year for 'ACEsimFit' from package DESCRIPTION file To cite package 'ACEsimFit' in publications use:    Lyu X, Garrison S (????). _ACEsimFit: ACE Kin Pair Data Simulations   and Model Fitting_. R package version 0.0.0.9.  A BibTeX entry for LaTeX users is    @Manual{,     title = {ACEsimFit: ACE Kin Pair Data Simulations and Model Fitting},     author = {Xuanyu Lyu and S.Mason Garrison},     note = {R package version 0.0.0.9},   }"},{"path":"https://r-computing-lab.github.io/ACEsimFit/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"ACE Kin Pair Data Simulations and Model Fitting","text":"user guide procudure, please check examples vignette.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Power_LS.html","id":null,"dir":"Reference","previous_headings":"","what":"Power_LS — Power_LS","title":"Power_LS — Power_LS","text":"function designed calculating power heritability estimation ACE models given parameter settings. calculate one parameter settings (N,R,h2,c2) given rest known parameters. power calculator made based Least Squares theory follows mathematical derivation proposed Visscher (2004).","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Power_LS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Power_LS — Power_LS","text":"","code":"Power_LS(   N1,   N2,   power,   p_N1 = NULL,   h2,   c2,   R1 = 1,   R2 = 0.5,   alpha = 0.05,   digits = 0 )"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Power_LS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Power_LS — Power_LS","text":"N1 number kin pairs group1 (amount PAIRS) N2 number kin pairs group2 power power heritability estimation. Specified want return required sample sizes. p_N1 proportion kin group1 . Required specified user wants calculate N1 N2 simultaneously. h2 assumed standard heritability value target trait. 0 < h2 < 1 c2 assumed standard common environmental effects target trait. 0 < c2 < 2 R1 genetic relatedness kin pair group1 R2 genetic relatedness kin pair group2 alpha type-one error rate heritability estimation. digits number digits round results. Default 0.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Power_LS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Power_LS — Power_LS","text":"numeric vector power N1 N2 specified.  numeric vector N1 (N2) N2 (N1) specified. numeric vector N1 N2 RatioN specified.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Sim_Fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Sim_Fit — Sim_Fit","title":"Sim_Fit — Sim_Fit","text":"function simulate set kin pair data fit ACE models. Can helpful checking model performance given parameter setting.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Sim_Fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sim_Fit — Sim_Fit","text":"","code":"Sim_Fit(   GroupNames = c(\"KinPair1\", \"KinPair2\"),   GroupSizes = c(100, 100),   nIter = 100,   SSeed = 62,   GroupRel = c(1, 0.5),   GroupR_c = c(1, 1),   mu = c(0, 0),   ace1 = c(1, 1, 1),   ace2 = c(1, 1, 1),   ifComb = FALSE,   lbound = FALSE,   saveRaw = FALSE )"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Sim_Fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sim_Fit — Sim_Fit","text":"GroupNames character vector specifying two names simulated kin pairs GroupSizes numeric vector specifying two group sizes indicating amount kin pairs respective group. nIter numeric value specifying number iteration want run given parameters assigned (.e. number model fitting results want get) SSeed integer specifying starting seed random number. parameter make sure simulated results replicable across time GroupRel numeric vector specifying two genetic relatedness values simulated kin pairs GroupR_c numeric vector specifying two common environment correlation coefficients simulated kin pairs mu numeric vector specifying two mean values generated variable kin pairs ace1 numeric vector specifying three variance components ACE (additive genetics, common environment, unique environment) structure group1 ace2 numeric vector specifying three variance components ACE (additive genetics, common environment, unique environment) structure group2 ifComb logical value specifying approach achieve required genetic relatedness value. TRUE = using combination approach. FALSE = using direct approach. (See function description detailed explanation two approaches.) lbound logical value indicating lower boundary .0001 imposed estimated , C E components saveRaw logical value specifying raw simulated data saved output list","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/Sim_Fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sim_Fit — Sim_Fit","text":"Returns two-level list. Level-one number iterations. Level-two model fitting results raw data (saveRaw = TRUE) simulated data respective iteration. Level-two includes: Results list including 1) data.frame displaying nested comparison model ACE, AE, CE, E models 2) list model fit information generated OpenMx Data data.frame consists simulated raw data","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/fit_uniACE.html","id":null,"dir":"Reference","previous_headings":"","what":"fit_uniACE — fit_uniACE","title":"fit_uniACE — fit_uniACE","text":"Use OpenMx quickly fit univariate ACE model","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/fit_uniACE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fit_uniACE — fit_uniACE","text":"","code":"fit_uniACE(   data_1,   data_2,   GroupRel = c(1, 0.5),   GroupR_c = c(1, 1),   lbound = FALSE )"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/fit_uniACE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"fit_uniACE — fit_uniACE","text":"data_1 n 2 data.frame consisting group1 kin pairs data_2 n 2 data.frame consisting group2 kin pairs GroupRel numeric vector specifying two genetic relatedness values two groups kin pairs GroupR_c numeric vector specifying two common environment correlation coefficients two groups kin pairs lbound logical value indicating lower boundary .0001 imposed estimated , C E components","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/fit_uniACE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fit_uniACE — fit_uniACE","text":"Returns list following: df_nested data.frame displaying nested comparison model ACE, AE, CE, E models fitACE list model fit information generated OpenMx","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_double.html","id":null,"dir":"Reference","previous_headings":"","what":"kinsim_double — kinsim_double","title":"kinsim_double — kinsim_double","text":"function generate two groups univariate kin pair(e.g., MZ DZ twins) data using multivariate norm approach, given ACE components.  Two approaches can selected: ) simulate two groups kin pairs using genetic relatedness directly b) simulate two groups kin pairs combining MZ twins DZ twins achieve required genetic relatedness (.5<R<1).","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_double.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kinsim_double — kinsim_double","text":"","code":"kinsim_double(   GroupNames = c(\"KinPair1\", \"KinPair2\"),   GroupSizes = c(100, 100),   GroupRel = c(1, 0.5),   GroupR_c = c(1, 1),   mu = c(0, 0),   ace1 = c(1, 1, 1),   ace2 = c(1, 1, 1),   ifComb = FALSE )"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_double.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"kinsim_double — kinsim_double","text":"GroupNames character vector specifying two names simulated kin pairs GroupSizes numeric vector specifying two group sizes indicating amount kin pairs respective group. GroupRel numeric vector specifying two genetic relatedness values simulated kin pairs GroupR_c numeric vector specifying two common environment correlation coefficients simulated kin pairs mu numeric vector specifying two mean values generated variable kin pairs ace1 numeric vector specifying three variance components ACE (additive genetics, common environment, unique environment) structure group1 ace2 numeric vector specifying three variance components ACE (additive genetics, common environment, unique environment) structure group2 ifComb logical value specifying approach achieve required genetic relatedness value. TRUE = using combination approach. FALSE = using direct approach. (See function description detailed explanation two approaches.)","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_double.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"kinsim_double — kinsim_double","text":"Returns data.frame following: GroupName group name kin pairs R level relatedness kin pair r_c level common envrionment correlation kin pairs id id A1 Additive genetic component kin1 kin pairs A2 Additive genetic component kin2 kin pairs C1 shared-environmental component kin1 kin pairs C2 shared-environmental component kin2 kin pairs E1 non-shared-environmental component kin1 kin pairs E2 non-shared-environmental component kin2 kin pairs y1 generated variable kin1 y2 generated variable kin2","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_single.html","id":null,"dir":"Reference","previous_headings":"","what":"kinsim_single — kinsim_single","title":"kinsim_single — kinsim_single","text":"function generate one group univariate kin pair (e.g., DZ twins) data using multivariate norm approach, given ACE components.","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kinsim_single — kinsim_single","text":"","code":"kinsim_single(   name = \"KinPair1\",   Rel = 1,   r_c = 1,   n = 100,   mu = 0,   ace = c(1, 1, 1) )"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"kinsim_single — kinsim_single","text":"name Assigned name simulated group kin pairs Rel Genetic relatedness simulated kin pairs r_c Assumed common environment correlation n number generated kin pairs.(n PAIRS data; total number participants 2n) mu mean generated variable ace Vector variance components ACE (additive genetics, common environment, unique environment) structure","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/kinsim_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"kinsim_single — kinsim_single","text":"Returns data.frame following: GroupName group name kin pairs R level genetic relatedness kin pairs r_c level common envrionment correlation kin pairs id id A1 Additive genetic component kin1 kin pairs A2 Additive genetic component kin2 kin pairs C1 shared-environmental component kin1 kin pairs C2 shared-environmental component kin2 kin pairs E1 non-shared-environmental component kin1 kin pairs E2 non-shared-environmental component kin2 kin pairs y1 generated variable kin1 y2 generated variable kin2","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/rmvn.html","id":null,"dir":"Reference","previous_headings":"","what":"rmvn — rmvn","title":"rmvn — rmvn","text":"rmvn","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/rmvn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rmvn — rmvn","text":"","code":"rmvn(n, sigma)"},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/rmvn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rmvn — rmvn","text":"n Sample Size sigma Covariance matrix","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/reference/rmvn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"rmvn — rmvn","text":"Generates multivariate normal data covariance matrix (sigma) length n","code":""},{"path":"https://r-computing-lab.github.io/ACEsimFit/news/index.html","id":"acesimfit-development-version","dir":"Changelog","previous_headings":"","what":"ACEsimFit (development version)","title":"ACEsimFit (development version)","text":"Added NEWS.md file track changes package. Exposed rounding parameter sim_kin_pairs() function.","code":""}]
